
{% load static %}
{% load i18n_tags %}
<nav class="bg-white shadow-lg fixed w-full z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <!-- Logo/Brand -->
            <div class="flex items-center">
                <a href="{% url 'index' %}" class="text-xl font-bold text-gray-800">
                    Portfolio
                </a>
            </div>
            
            <!-- Desktop Navigation + Language Selector -->
            <div class="hidden md:flex items-center space-x-6">
                <!-- Navigation Links -->
                <div class="flex items-center space-x-8">
                    <a href="#home" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">{% translate "Home" %}</a>
                    <a href="#about" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">{% translate "About" %}</a>
                    <a href="#experience" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">{% translate "Experience" %}</a>
                    <a href="#projects" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">{% translate "Projects" %}</a>
                    <a href="#contact" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">{% translate "Contact" %}</a>
                </div>
                
                <!-- Language Selector Desktop -->
                <div class="relative ml-4">
                    <form action="{% url 'set_language' %}" method="post" id="language-form-desktop" class="m-0">
                        {% csrf_token %}
                        <input name="next" type="hidden" value="{{ request.path }}">
                        <div class="flex items-center">
                            <select name="language" 
                                    class="appearance-none bg-gray-50 border border-gray-300 rounded-lg px-4 py-2 pr-10 leading-tight focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-sm cursor-pointer transition-all duration-200 hover:bg-gray-100"
                                    onchange="document.getElementById('language-form-desktop').submit()">
                                <option value="en" {% get_current_language as current_lang %}{% if current_lang == 'en' %}selected{% endif %}>
                                    ðŸ‡ºðŸ‡¸ English
                                </option>
                                <option value="es" {% if current_lang == 'es' %}selected{% endif %}>
                                    ðŸ‡ªðŸ‡¸ EspaÃ±ol
                                </option>
                                <option value="pt-br" {% if current_lang == 'pt-br' %}selected{% endif %}>
                                    ðŸ‡§ðŸ‡· PortuguÃªs
                                </option>
                            </select>
                            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-500">
                                <i class="fas fa-chevron-down text-xs"></i>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Mobile Menu Button -->
            <div class="md:hidden flex items-center space-x-4">
                <!-- Language Selector Mobile (simplificado) -->
                <div class="relative">
                    <form action="{% url 'set_language' %}" method="post" id="language-form-mobile">
                        {% csrf_token %}
                        <input name="next" type="hidden" value="{{ request.path }}">
                        <select name="language" 
                                class="appearance-none bg-gray-50 border border-gray-300 rounded-lg px-3 py-1.5 pr-8 text-sm focus:outline-none focus:border-blue-500"
                                onchange="document.getElementById('language-form-mobile').submit()">
                            <option value="en" {% if current_lang == 'en' %}selected{% endif %}>EN</option>
                            <option value="es" {% if current_lang == 'es' %}selected{% endif %}>ES</option>
                            <option value="pt-br" {% if current_lang == 'pt-br' %}selected{% endif %}>PT</option>
                        </select>
                    </form>
                </div>
                
                <!-- Hamburger Menu Button -->
                <button id="mobile-menu-btn" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Menu (Dropdown) -->
    <div id="mobile-menu" class="md:hidden hidden bg-white shadow-lg border-t border-gray-100">
        <div class="px-4 py-4 space-y-3">
            <a href="#home" class="block px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                <i class="fas fa-home w-5 mr-3 text-center"></i>
                {% translate "Home" %}
            </a>
            <a href="#about" class="block px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                <i class="fas fa-user w-5 mr-3 text-center"></i>
                {% translate "About" %}
            </a>
            <a href="#experience" class="block px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                <i class="fas fa-briefcase w-5 mr-3 text-center"></i>
                {% translate "Experience" %}
            </a>
            <a href="#projects" class="block px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                <i class="fas fa-code w-5 mr-3 text-center"></i>
                {% translate "Projects" %}
            </a>
            <a href="#contact" class="block px-4 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors duration-200">
                <i class="fas fa-envelope w-5 mr-3 text-center"></i>
                {% translate "Contact" %}
            </a>
            
            <!-- Language Selector in Mobile Menu -->
            <div class="pt-4 mt-4 border-t border-gray-100">
                <div class="px-4">
                    <p class="text-xs font-medium text-gray-500 uppercase tracking-wider mb-3">{% translate "Language" %}</p>
                    <form action="{% url 'set_language' %}" method="post" id="language-form-mobile-menu">
                        {% csrf_token %}
                        <input name="next" type="hidden" value="{{ request.path }}">
                        <div class="space-y-2">
                            <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors duration-200">
                                <input type="radio" name="language" value="en" 
                                       {% if current_lang == 'en' %}checked{% endif %}
                                       onchange="document.getElementById('language-form-mobile-menu').submit()"
                                       class="mr-3 text-blue-600 focus:ring-blue-500">
                                <span class="flex-1">ðŸ‡ºðŸ‡¸ English</span>
                            </label>
                            <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors duration-200">
                                <input type="radio" name="language" value="es" 
                                       {% if current_lang == 'es' %}checked{% endif %}
                                       onchange="document.getElementById('language-form-mobile-menu').submit()"
                                       class="mr-3 text-blue-600 focus:ring-blue-500">
                                <span class="flex-1">ðŸ‡ªðŸ‡¸ EspaÃ±ol</span>
                            </label>
                            <label class="flex items-center p-3 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors duration-200">
                                <input type="radio" name="language" value="pt-br" 
                                       {% if current_lang == 'pt-br' %}checked{% endif %}
                                       onchange="document.getElementById('language-form-mobile-menu').submit()"
                                       class="mr-3 text-blue-600 focus:ring-blue-500">
                                <span class="flex-1">ðŸ‡§ðŸ‡· PortuguÃªs</span>
                            </label>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</nav>

<script>
// Mobile menu toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (menuBtn && mobileMenu) {
        menuBtn.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
            // Toggle between hamburger and close icon
            const icon = menuBtn.querySelector('i');
            if (mobileMenu.classList.contains('hidden')) {
                icon.className = 'fas fa-bars text-xl';
            } else {
                icon.className = 'fas fa-times text-xl';
            }
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            if (!mobileMenu.contains(event.target) && !menuBtn.contains(event.target) && !mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
                menuBtn.querySelector('i').className = 'fas fa-bars text-xl';
            }
        });
        
        // Smooth scroll for anchor links in mobile menu
        document.querySelectorAll('#mobile-menu a[href^="#"]').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
                menuBtn.querySelector('i').className = 'fas fa-bars text-xl';
            });
        });
    }
    
    // Active link highlighting based on scroll position
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('nav a[href^="#"]');
    
    function highlightActiveLink() {
        let scrollPosition = window.scrollY + 100;
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            const sectionId = section.getAttribute('id');
            
            if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                navLinks.forEach(link => {
                    link.classList.remove('text-blue-600', 'font-semibold');
                    if (link.getAttribute('href') === `#${sectionId}`) {
                        link.classList.add('text-blue-600', 'font-semibold');
                    }
                });
            }
        });
    }
    
    window.addEventListener('scroll', highlightActiveLink);
    highlightActiveLink(); // Initial call
});
</script>